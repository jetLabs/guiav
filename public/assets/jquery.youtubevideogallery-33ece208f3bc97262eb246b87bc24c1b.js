!function(e){"use strict";e.fn.extend({youtubeVideoGallery:function(t){function i(e){"console"in window&&window.console.log&&window.console.log(e)}function n(t){var i=[],n=t.find("a");return n.each(function(t,n){i.push({id:r(e(n).attr("href")),title:e(n).text()})}),i}function o(e){if("string"==typeof e)return r(e);if(e.id&&"string"==typeof e.id)return e.id;if(e.link&&e.link.length)for(var t=0,n=e.link.length;n>t;t++)if("text/html"===e.link[t].type)return r(e.link[t].href);return i("could not find ID from object, maybe an unsupported API?"),""}function r(e){var t="";return e&&e.indexOf("www.youtube.com/v/")>0?t=l(e.split("www.youtube.com/v/")[1],"?"):e&&e.indexOf("/embed/")>0?t=l(e.split("/embed/")[1],"?"):e&&e.indexOf("?v=")>0?t=l(e.split("?v=")[1],"&"):e&&e.indexOf("video:")>0?t=l(e.split("video:")[1],":"):e&&(t=e),t}function l(e,t){return e&&e.indexOf(t)&&(e=e.split(t)[0]),e}function a(e,i){var n=t.iframeTemplate;return n.replace("{options.innerHeight}",i).replace("{options.innerWidth}",e)}function d(i){var n=i.currentTarget;i.preventDefault(),e("div.youtube-videogallery-bodycover").css({height:e(document).height()}),e("div.youtube-videogallery-display").css({marginLeft:-t.innerWidth/2,marginTop:-t.innerHeight/2}),e("#youtube-videogallery-iframe").attr("src",t.urlEmbed.replace("$id",e(n).attr("data-youtube-id"))),e("body").addClass("youtube-videogallery-active")}function u(){e("#youtube-videogallery-iframe").attr("src","about:blank"),e("body").removeClass("youtube-videogallery-active")}function s(t,i,n){return 0===t||0===i?void e(n).find("img.youtube-videogallery-play").remove():void e(n).find("img.youtube-videogallery-play").css({marginLeft:-t/2+"px",marginTop:-i/2+"px"})}function y(e){return e?"youtube-videogallery-"+e:""}function c(e){return"full"===e?"youtube-videogallery-allowtitle":""}function f(t){var i=[],n=t&&t.data&&t.data.items?t.data.items:t&&t.feed&&t.feed.entry?t.feed.entry:[];return e(n).each(function(e,t){o(t);i.push({id:o(t),title:t.title.$t||t.title})}),i}function p(t,i){var o,r,l,f,p=i.videos.length?i.videos:n(t),g="",b=i.assetFolder?i.assetFolder+"/assets/"+i.playButton:i.playButton,h=document.createElement("img");h.onload=function(){s(this.width,this.height,t)},h.onerror=function(){s(0,0,t)},h.src=b+"?"+ +new Date;for(var v=0,m=p.length;m>v;v++)f=p[v],f.id&&(o=i.urlLink.replace("$id",f.id),r=i.urlImg.replace("$id",f.id),l=f.title&&"none"!==i.title?'<span class="youtube-videogallery-title">'+f.title+"</span>":"",g+='<li class="youtube-videogallery-item"><a title="'+f.title+'" data-youtube-id="'+f.id+'" href="'+o+'" class="youtube-videogallery-link" style="width:'+i.thumbWidth+'px"><img class="youtube-videogallery-play" src="'+b+'" title="play" /><img class="youtube-videogallery-img" src="'+r+'" style="width:'+i.thumbWidth+'px" />'+l+"</a></li>");return t.empty().append(g).addClass("youtube-videogallery-container").addClass(y(i.style)).addClass(c(i.title)),i.supported&&"colorbox"===i.plugin&&e.colorbox?t.find("a.youtube-videogallery-link").each(function(t,n){e(n).attr("href",i.urlEmbed.replace("$id",e(n).attr("data-youtube-id"))).attr("aria-controls","youtube-videogallery-iframe").colorbox({iframe:!0,innerWidth:i.innerWidth,innerHeight:i.innerHeight})}):i.supported&&"fancybox"===i.plugin&&e().fancybox?t.find("a.youtube-videogallery-link").each(function(t,n){e(n).attr("rel","media-gallery").fancybox(i.fancybox)}):i.supported&&"self"===i.plugin?(e("div.youtube-videogallery-bodycover").length||(e("body").append('<div class="youtube-videogallery-bodycover"/>').append('<div class="youtube-videogallery-display">'+a(i.innerWidth,i.innerHeight)+"</div>"),e("div.youtube-videogallery-bodycover").on("click",u),e(document).on("keydown",function(e){27===e.which&&u()})),t.find("a.youtube-videogallery-link").on("click",d)):t.find("a.youtube-videogallery-link").attr("target","_blank").append('<span class="youtube-videogallery-screen-reader-only">'+i.newWindow+"</span>").each(function(t,n){e(n).attr("title",e(n).attr("title")+" "+i.newWindow)}),t}var g="1.3.0",b=/\bMSIE [4|5|6|7]/.test(navigator.userAgent),h={assetFolder:"",fancybox:{arrows:!1,closeBtn:!0,closeEffect:"fade",helpers:{media:{},buttons:{}},openEffect:"fade"},forceLegacyIE:!1,iframeTemplate:'<iframe title="Youtube video player" id="youtube-videogallery-iframe" style="height:{options.innerHeight}px;width:{options.innerWidth}px;" frameborder="0" src="about:blank" />',innerHeight:344,innerWidth:425,newWindow:"(opens in a new window)",playButton:"/assets/play-button-red@40.png",plugin:"self",style:"",title:"default",thumbWidth:150,videos:[],urlImg:"http://img.youtube.com/vi/$id/0.jpg",urlEmbed:"http://www.youtube.com/embed/$id",urlLink:"http://www.youtube.com/watch?v=$id"};if(this.test={},this.version=g,this.test={getBefore:l,getId:r,getVideoLinks:n,getIframeTemplate:a,getTitleStyle:c,getStyle:y,getVideosFromFeed:f,getIdFromEntry:o},t=e.extend(h,t),t.supported=!!e().on&&(e(window).width()>t.innerWidth||e(window).height()>t.innerHeight),t.plugin=b&&!t.forceLegacyIE?"none":t.plugin,t.apiUrl){{var v=this,m=t.apiUrl;e.ajax({url:m,dataType:"jsonp",beforeSend:function(){t.apiFallbackUrl&&v.each(function(i,n){e(n).empty().append("<li><a /></li>").find("a").attr("href",t.apiFallbackUrl).text(t.apiFallbackUrl)})}}).done(function(i){t.videos=f(i),v.each(function(i,n){p(e(n),t)})}).fail(function(){i("Error getting youtube API requested by jQuery.youtubeVideoGallery: "+m)})}return v}return this.each(function(i,n){p(e(n),t)})}})}(window.jQuery);